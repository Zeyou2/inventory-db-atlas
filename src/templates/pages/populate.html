{% extends "index.html" %}
{% block content %}
<div class="container mt-4">
            <h1 class="text-center m-4"> Movimentação de Produtos</h1>

        <div class="dropdown">
                <button class="btn btn-default dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Selecione a Categoria
                </button>
                <ul class="dropdown-menu" role="menu">
                {% for opt in options %}
                  <li>
                    <a class="dropdown-item" href="{{  url_for('operation', op_type=opt)  }}" >{{opt}}</a>
                  </li>
                {% endfor %}
                </ul>
        </div>
        {% if op_type != None %}
        <p class="h2">{{op_type}}</p>
        <form action="{{ url_for('send', collection_name=title) }}" method="POST">

                <fieldset>
                    {% for x in field %}
                    <div class="form-group" style="font-weight: bold;">
                        <!-- This is a fixed control form used to register the actual date. -->
                        {% if x['pergunta'] == "Categoria do Produto" %}
                        <label for="{{ x['db_id'] }}">{{ x['pergunta'] }}</label>
                        <select id="{{ x['db_id'] }}" name="{{ x['db_id'] }}" class="form-control" onchange="toggleNewCategory(this)" >
                            {% for el in x['list_elements'] %}
                                <option value="{{ el }}">{{ el }}</option>
                            {% endfor %}
                            <option value="nova_categoria">Nova Categoria</option>
                         
                        </select>
                            {% if categoria == nova_categoria %}
                            <input type="text" id="nova_categoria_input" name="nova_categoria" class="form-control mt-2" placeholder="Digite nova categoria" style="display: none;">
                            {% endif %}
        
                        {% elif x['resp_type'] == "list" %}
                            <label for="{{ x['db_id'] }}">{{ x['pergunta'] }}</label>
                            <select id="{{ x['db_id'] }}" name="{{ x['db_id'] }}" value="{{ x['pre_value'] }}" class="form-control" {{ x["em_branco"] }} {{ x['form_editable'] }}>
                                {% for el in x['list_elements'] %}
                                    
                                    <option value ="{{el}}">{{el}}</option>
        
                                {% endfor %}
                            </select>
                        {% else %}
                            <label for="{{ x['db_id'] }}">{{ x["pergunta"] }}</label>
                            <input type="{{ x['resp_type'] }}" id="{{ x['db_id'] }}" name="{{ x['db_id'] }}" value="{{ x['pre_value'] }}" class="form-control" {{ x["em_branco"] }} {{ x['form_editable'] }} >
                        {% endif %}
                        </div>
                    {% endfor %}
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </fieldset>
            </form>
        {% endif %}
</div> 
{% endblock %}


